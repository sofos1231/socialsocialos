openapi: 3.0.3
info:
  title: SocialGym Backend API
  version: 1.0.0
  description: Minimal API to ingest practice sessions and expose dashboard stats.
servers:
  - url: http://localhost:3000
paths:
  /v1/sessions:
    post:
      summary: Create a new practice session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PracticeSession'
            example:
              userId: 11111111-1111-1111-1111-111111111111
              category: dating
              score: 82
              durationMinutes: 30
              feedback: Solid confidence
          application/xml:
            schema:
              $ref: '#/components/schemas/PracticeSession'
            example: |
              <PracticeSession>
                <userId>11111111-1111-1111-1111-111111111111</userId>
                <category>dating</category>
                <score>87</score>
                <durationMinutes>25</durationMinutes>
                <feedback>Showed good confidence and humor.</feedback>
              </PracticeSession>
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  sessionId:
                    type: integer
                  createdAt:
                    type: string
                    format: date-time
              example:
                sessionId: 123
                createdAt: 2025-01-01T12:00:00.000Z
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /v1/dashboard/{userId}:
    get:
      summary: Get dashboard stats for user
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
            format: uuid
          description: User ID (UUID)
      responses:
        '200':
          description: Stats for the user
          content:
            application/json:
              schema:
                type: object
                properties:
                  sessions_count:
                    type: integer
                  avg_score_pct:
                    type: number
                    format: float
                    description: Average score in percent
              example:
                sessions_count: 5
                avg_score_pct: 83.4
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  schemas:
    PracticeSession:
      type: object
      xml:
        name: PracticeSession
      properties:
        userId:
          type: string
          format: uuid
        category:
          type: string
        score:
          type: number
          format: float
          description: Score as percent between 0 and 100
        durationMinutes:
          type: number
          format: float
        feedback:
          type: string
          nullable: true
        missionId:
          type: string
          nullable: true
      required:
        - userId
        - category
        - score
        - durationMinutes
    Error:
      type: object
      properties:
        error:
          type: string


